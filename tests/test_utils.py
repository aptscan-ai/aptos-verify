import pytest

import aptos_verify.utils as utils
from aptos_verify.schemas import VerifyArgs


@pytest.mark.skip
async def test_get_bytecode():
    params = VerifyArgs(
        module_id='0x8d2d7bcde13b2513617df3f98cdd5d0e4b9f714c6308b9204fe18ad900d92609::admin',
    )
    bytecode = await utils.AptosRpcUtils.rpc_account_get_bytecode(
        account_address=params.account_address,
        module_name=params.module_name
    )
    assert bytecode.get('bytecode') == '0xa11ceb0b060000000c01000c020c0e031a65047f0e058d018701079402940308a8054006e8054010a8066b0a9307070c9a079d030db70a0400000101010201030104010500060800020704010001050a07000008000101000009020300000b04030100000c05030100000d060300000e060300000f07030000100803010000110903010000120a0301000215000101000416020c0002170203010002180c0d010002190e010100021a0f030100011b110300031c1313000a0b0c0b0d0b0e0b0f0b000b070b02070b0101090003010b0101090001060c0002060c080204060c060c03080202060c0504060c0503080205060c050303080207060c030a050a030a0301080207060c060c0503050308020109000105010102060c0302050b010109000107080003060c050304010b010109000608000b010109000103050301050303020b010109000b010109000561646d696e0d6170746f735f6163636f756e7404636f696e056572726f72067369676e657206737472696e67125472616e73666572436f6d6d697373696f6e04436f696e0f6465647563745f666c61745f6665650b696e69745f6d6f64756c6506537472696e670d72656769737465725f636f696e1a72656769737465725f636f696e5f616e645f7472616e73666572117365745f61646d696e5f61646472657373147365745f74726561737572795f616464726573730e7472616e736665725f6170746f73187472616e736665725f636f696e5f636f6d6d697373696f6e1c7472616e736665725f6d756c7469706c655f636f6d6d697373696f6e197472616e736665725f74776f5f736f75726365735f6d656d6f0d61646d696e5f616464726573731074726561737572795f6164647265737307657874726163740a616464726573735f6f660872656769737465721569735f6163636f756e745f72656769737465726564087769746864726177076465706f736974087472616e73666572117065726d697373696f6e5f64656e6965648d2d7bcde13b2513617df3f98cdd5d0e4b9f714c6308b9204fe18ad900d92609000000000000000000000000000000000000000000000000000000000000000103080300000000000000030801000000000000000308020000000000000005208d2d7bcde13b2513617df3f98cdd5d0e4b9f714c6308b9204fe18ad900d92609126170746f733a3a6d657461646174615f7631570301000000000000000f454e4f545f52454749535445524544000200000000000000184554524541535552595f4e4f545f524547495354455245440003000000000000000f454e4f545f415554484f52495a4544000000000202130514050000000003040b000b013800020100000003080a000a00110b0b00110b12002d00020201040003030b003801020301040001100a01110b38022004070a0138010b000b0238030c040b01110b0b043804020401040100101407032a000c020b00110b0a0210001421040b050f0b02010700270b010b020f0015020501040100101407032a000c020b00110b0a0210001421040b050f0b02010700270b010b020f0115020601040003050b000b010b021110020701040100122807032b000c070b000b0238030c080d080a0338050c060a0710011438020413080c0505170b03060000000000000000210c050b05041a051f0b070107021111270b071001140b0638040b010b08380402080104010014330600000000000000000c070a070a0123043005070e020a07420c140c090e030a074213140c0a0e040a074213140c0b0a0938020c080a080a051e041e05230b000107011111270b08042b0a000b090b0a0b0b0a0638060b07060100000000000000160c0705020b00010209010400150f0b000b0338030c070b020b0738040b010b0538030c080b040b083804020000000100'


@pytest.mark.skip
async def test_get_source_code():
    params = VerifyArgs(
        module_id='0x8d2d7bcde13b2513617df3f98cdd5d0e4b9f714c6308b9204fe18ad900d92609::admin',
    )
    bytecode = await utils.AptosRpcUtils.rpc_account_get_source_code(
        account_address=params.account_address,
        module_name=params.module_name
    )
    assert bytecode.get('module') != None

@pytest.mark.skip
async def test_extract_bytecode():
  
    bytecode = await utils.AptosBytecodeUtils.extract_bytecode_from_build(
        move_path='/Users/phong/aptos_verify_tmp/buiding_0xea31fe7bbc4304e174e7ccf72663a3ccdd974d28c9d4424ffa3c18d780859d44_1701158038532',
        module_name='PRT__MLWNAZ'
    )
    assert bytecode.get('module') != None
